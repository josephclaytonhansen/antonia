$((function () { const t = $("#flipbook").length ? $("#flipbook") : $(document), e = t.find(".book"), n = t.find(".hero-frame-left, .hero-frame-right"), o = document.getElementById("scrolldown"), a = document.querySelector(".page-scroll-spacer"), r = document.querySelector(".hero"), s = document.querySelector(".new-content-section"); let c = !1; const l = t => { const e = parseFloat(String(t).trim()); return isNaN(e) ? null : e }, i = (t, n = null) => { let o = null; try { o = e[0]?.closest("[data-open-start],[data-start],[data-open-end],[data-end],[data-open-boost],[data-open-smoothing],[data-open-easing]") } catch (t) { } const r = [a, o, e[0]]; for (const e of Array.isArray(t) ? t : [t]) { const t = e.replace(/-(\w)/g, ((t, e) => e.toUpperCase())); for (const e of r) { const n = e?.dataset?.[t]; if (null != n) return n } } return n }, p = l(i("openBoost")), m = l(i(["openBoostLeft", "openboostleft"])), y = l(i(["openBoostRight", "openboostright"])), d = m ?? p ?? 20, h = y ?? p ?? 20, u = parseFloat(i(["openOverrun", "openoverrun"])), f = !isNaN(u) && u >= 0 ? Math.min(.2, u) : .03, g = { ".front": -160, ".page1": -150, ".page2": -30, ".page3": -140, ".page4": -40, ".page5": -130, ".page6": -50, ".back": -20 }, w = [".front", ".page1", ".page3", ".page5"]; function v(o) { o = Math.max(0, Math.min(1, o)); try { e[0]?.style.setProperty("--book-turn", o) } catch (t) { } const a = Math.max(0, Math.min(1, (o - .05) / .95)); t.find(".spine").css("opacity", a); const r = Math.min(10, 18 * o), s = 1 + .1 * o, c = 1 - .1 * o, l = .2 * o; n.length && n.css("transform", `scale(${c})`), Object.entries(g).forEach((([t, n]) => { const a = e.find(t); if (a.length) { let e = `rotateY(${(n + (w.includes(t) ? h : d)) * o}deg) scale(${s})`; ".back" === t ? e += ` translateX(${-r}px)` : a.css("box-shadow", `0 1em 3em 0 rgba(0,0,0,${l})`), a.css("transform", e) } })) } function S() { c || (c = !0, requestAnimationFrame((() => { try { const e = window.scrollY || document.documentElement.scrollTop, n = window.innerHeight || document.documentElement.clientHeight, a = 4 * n, l = 6 * n, i = 8 * n; if (e < a) { const n = Math.min(1, e / (.7 * a)), c = Math.min(1, n + f * (1 - n)), l = (t = c, 1 - Math.pow(1 - t, 3)); v(l), r && (r.style.transform = "translateY(0)", r.style.opacity = "1"); const i = document.querySelector("main header h1") || document.querySelector("header h1") || document.querySelector("main h1"); i && (i.style.fontSize = "min(10vw, 5rem)"), s && (s.style.transform = "translateY(100vh)", s.style.opacity = "0"), o && (o.style.opacity = String(.5 * (1 - l))) } else if (e >= l && e < i) { const t = (t => t < .5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2)((e - l) / (i - l)); v(1); const n = document.querySelector("main header h1") || document.querySelector("header h1") || document.querySelector("main h1"); if (n && (n.style.fontSize = "min(6vw, 3rem)"), r) { const e = -100 * t, n = 1 - t; r.style.transform = `translateY(${e}vh)`, r.style.opacity = String(n) } if (s) { const e = 100 - 100 * t, n = t; s.style.transform = `translateY(${e}vh)`, s.style.opacity = String(n) } o && (o.style.opacity = "0") } else e >= i && (v(1), r && (r.style.transform = "translateY(-100vh)", r.style.opacity = "0"), s && (s.style.transform = "translateY(0)", s.style.opacity = "1"), o && (o.style.opacity = "0")); c = !1 } catch (t) { console.error("Scroll error:", t), c = !1 } var t }))) } v(0), o && (o.style.opacity = String(.5)), r && (r.style.transform = "translateY(0)", r.style.opacity = "1"), s && (s.style.transform = "translateY(100vh)", s.style.opacity = "0"), function () { if (!window.matchMedia?.("(hover: none)").matches) try { e.css("pointer-events", "none"), e.find(".front, .page1, .page2, .page3, .page4, .page5, .page6, .back").css("pointer-events", "auto") } catch (t) { } }(), a && (a.style.height = "900vh"), window.addEventListener("scroll", S, { passive: !0 }), window.addEventListener("resize", S), function () { const t = document.getElementById("newContent") || document.querySelector(".new-content-section"); t && (t.removeAttribute("hidden"), t.style.setProperty("display", "flex", "important")) }(), S() }));